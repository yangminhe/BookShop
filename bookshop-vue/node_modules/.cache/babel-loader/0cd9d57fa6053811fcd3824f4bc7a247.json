{"remainingRequest":"/Volumes/Application/bookshop11/bookshop-vue/node_modules/babel-loader/lib/index.js!/Volumes/Application/bookshop11/bookshop-vue/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Volumes/Application/bookshop11/bookshop-vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/Application/bookshop11/bookshop-vue/src/fore/ProductPage.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Volumes/Application/bookshop11/bookshop-vue/src/fore/ProductPage.vue","mtime":1665085420000},{"path":"/Volumes/Application/bookshop11/bookshop-vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/Application/bookshop11/bookshop-vue/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Volumes/Application/bookshop11/bookshop-vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/Application/bookshop11/bookshop-vue/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHsgZm9ybWF0RGF0ZSBhcyBfZm9ybWF0RGF0ZSB9IGZyb20gIi4uL3N0b3JlL2Zvcm1hdERhdGUiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIlByb2R1Y3RQYWdlIiwKICBmaWx0ZXJzOiB7CiAgICBmb3JtYXREYXRlOiBmdW5jdGlvbiBmb3JtYXREYXRlKHRpbWUpIHsKICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSh0aW1lKTsKICAgICAgcmV0dXJuIF9mb3JtYXREYXRlKGRhdGUsICJ5eXl5LU1NLWRkIGhoOm1tIik7CiAgICB9CiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgdGFsa2luZzogIiIsCiAgICAgIC8vIOivhOiuuuWGheWuuQogICAgICB1cmk6ICJwcm9kdWN0IiwKICAgICAgY29tbWVudFVybDogInJldmlldy9hZGQiLAogICAgICBiZWFuOiBbXSwKICAgICAgcmV2aWV3OiBbXSwKICAgICAgbnVtOiAxLAogICAgICBhY3RpdmVOYW1lczogWyIxIl0KICAgIH07CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgdGhpcy5nZXREYXRhKCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBnZXREYXRhOiBmdW5jdGlvbiBnZXREYXRhKCkgewogICAgICB2YXIgdGhhdCA9IHRoaXM7CiAgICAgIHZhciBpZCA9IHRoYXQuJHJvdXRlLnF1ZXJ5LmlkOwogICAgICB2YXIgdXJsID0gdGhhdC51cmkgKyAiLyIgKyBpZDsKICAgICAgdGhhdC5heGlvcy5nZXQodXJsKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICB2YXIgcmVzdWx0ID0gcmVzLmRhdGE7CiAgICAgICAgdGhhdC4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgdGhhdC5iZWFuID0gcmVzdWx0LmRhdGEucHJvZHVjdDsgLy8g5Lmm5pys55qE5a+56LGhCgogICAgICAgICAgdGhhdC5yZXZpZXcgPSByZXN1bHQuZGF0YS5yZXZpZXdzOyAvLyDor4TorrrnmoTmlbDnu4QKICAgICAgICB9KTsKICAgICAgICB0aGF0LiRmb3JjZVVwZGF0ZSgpOwogICAgICB9KTsKICAgIH0sCiAgICBkb0NvbWVudEZ1bjogZnVuY3Rpb24gZG9Db21lbnRGdW4oKSB7CiAgICAgIC8vIOWkhOeQhuivhOiuuumAu+i+kQogICAgICB2YXIgdGhhdCA9IHRoaXM7CiAgICAgIGlmICghdGhhdC50YWxraW5nKSByZXR1cm47IC8vIGFwaS9yZXZpZXcvYWRkP3BpZD0xMCZjb250ZW50PeWWnOasojY2NgoKICAgICAgdmFyIHRtZXBUYWxrID0gdGhhdC50YWxraW5nOyAvLyDor4TorrrnmoTlhoXlrrkKCiAgICAgIHZhciBwSWQgPSB0aGF0LmJlYW4uaWQ7IC8vIOivhOiuuueahOWGheWuuQoKICAgICAgdmFyIHVybCA9IHRoYXQuY29tbWVudFVybCArICI/cGlkPSIgKyBwSWQgKyAiJmNvbnRlbnQ9IiArIHRtZXBUYWxrOwogICAgICB0aGF0LmF4aW9zLnBvc3QodXJsKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIGlmIChyZXNwb25zZS5kYXRhLmNvZGUgPT09IDIwMCkgewogICAgICAgICAgdGhhdC50YWxraW5nID0gIiI7IC8vIOe9ruepuuivhOiuugoKICAgICAgICAgIHRoYXQuZ2V0RGF0YSgpOwogICAgICAgICAgdGhhdC4kYWxlcnQoJ+ivhOiuuuaIkOWKnycsICdzdWNjZXNzJywgewogICAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGF0LiRhbGVydCgn6K+E6K665aSx6LSlJywgJ2Vycm9yJywgewogICAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikgewogICAgICAgIHRoYXQuJGFsZXJ0KCfor4TorrrlpLHotKUnLCAnZXJyb3InLCB7CiAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgaGFuZGxlQnV5OiBmdW5jdGlvbiBoYW5kbGVCdXkoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBpZiAoIXNlc3Npb25TdG9yYWdlLmdldEl0ZW0oInVzZXIiKSkgewogICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCIvbG9naW4iKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgcGlkID0gdGhpcy5iZWFuLmlkOwogICAgICAgIHZhciB1cmwgPSAiYnV5P3BpZD0iICsgcGlkICsgIiZudW09IiArIHRoaXMubnVtOwogICAgICAgIHRoaXMuYXhpb3MuZ2V0KHVybCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIHZhciBvaWlkID0gcmVzcG9uc2UuZGF0YTsKCiAgICAgICAgICBfdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgICAgICBwYXRoOiAiL2NvbmZpcm0iLAogICAgICAgICAgICBxdWVyeTogewogICAgICAgICAgICAgIG9paWQ6IG9paWQKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBoYW5kbGVBZGQ6IGZ1bmN0aW9uIGhhbmRsZUFkZCgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICBpZiAoIXNlc3Npb25TdG9yYWdlLmdldEl0ZW0oInVzZXIiKSkgewogICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCIvbG9naW4iKTsKICAgICAgfQoKICAgICAgdmFyIHBpZCA9IHRoaXMuYmVhbi5pZDsKICAgICAgdmFyIHVybCA9ICJhZGRDYXJ0P3BpZD0iICsgcGlkICsgIiZudW09IiArIHRoaXMubnVtOwogICAgICB0aGlzLmF4aW9zLmdldCh1cmwpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgdmFyIHJlc3VsdCA9IHJlc3BvbnNlLmRhdGE7CgogICAgICAgIGlmICgyMDAgPT0gcmVzdWx0LmNvZGUpIHsKICAgICAgICAgIF90aGlzMi4kbWVzc2FnZSgi5bey5Yqg5YWl6LSt54mp6L2mIik7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["ProductPage.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <el-row :gutter=\"40\" style=\"text-align: center\">\n      <el-col :span=\"6\" :offset=\"6\">\n        <el-image\n          :src=\"bean.image\"\n          :lazy=\"true\"\n          fit=\"fill\"\n          style=\"height: 368px; width: 260px\"\n        />\n      </el-col>\n      <el-col :span=\"6\">\n        <h3>{{ bean.name }}</h3>\n        <p style=\"color: #9d9d9d\">{{ bean.author }}</p>\n        <h2 style=\"color: #fb4e44\">￥{{ bean.price }}</h2>\n        <el-tag type=\"success\">{{ bean.discount }}折</el-tag>\n        <p>{{ bean.publisher }}</p>\n        <el-input-number v-model=\"num\" :min=\"1\" :max=\"10\" />\n        <p>库存：{{ bean.stock }}件</p>\n        <el-button type=\"warning\" plain @click=\"handleAdd\"\n          >加入购物车</el-button\n        >\n        <el-button type=\"danger\" @click=\"handleBuy\">立即购买</el-button>\n      </el-col>\n    </el-row>\n    <el-row style=\"text-align: center; margin-top: 50px\">\n      <el-col :span=\"12\" :offset=\"6\">\n        <el-collapse>\n          <el-collapse-item title=\"评论\" style=\"text-align: left\">\n            <template slot=\"title\">\n              <i class=\"el-icon-copy-document\" />{{\n                bean.reviewCount\n              }}条书友评论999\n            </template>\n\n            <div class=\"commentCss\">\n              <el-input\n                type=\"textarea\"\n                :rows=\"2\"\n                placeholder=\"请输入评论内容\"\n                v-model=\"talking\">\n                </el-input>\n              <el-button type=\"primary\" @click.stop=\"doComentFun\">发布</el-button>\n            </div>\n\n            <!-- 评论卡片start -->\n            <el-card v-for=\"item in review\" :key=\"item.key\">\n              <el-tag v-if=\"item.user\">{{ item.user.name }}</el-tag>\n\n              <p>{{ item.content }}</p>\n\n              <el-tag type=\"info\" style=\"text-align: right\">{{\n                item.createTime | formatDate\n              }}</el-tag>\n            </el-card>\n            <!-- 评论卡片end -->\n          </el-collapse-item>\n        </el-collapse>\n      </el-col>\n    </el-row>\n  </div>\n</template>\n\n<script>\nimport { formatDate } from \"../store/formatDate\";\nexport default {\n  name: \"ProductPage\",\n  filters: {\n    formatDate(time) {\n      let date = new Date(time);\n      return formatDate(date, \"yyyy-MM-dd hh:mm\");\n    },\n  },\n  data() {\n    return {\n      talking: \"\", // 评论内容\n\n      uri: \"product\",\n      commentUrl: \"review/add\",\n\n      bean: [],\n      review: [],\n      num: 1,\n      activeNames: [\"1\"],\n    };\n  },\n  mounted() {\n    this.getData();\n  },\n \n  methods: {\n    getData(){\n        let that = this;\n        let id = that.$route.query.id;\n        let url = that.uri + \"/\" + id;\n        that.axios.get(url).then((res) => {\n        let result = res.data;\n        that.$nextTick(()=>{\n            that.bean = result.data.product;// 书本的对象\n            that.review = result.data.reviews;// 评论的数组\n        });\n        that.$forceUpdate();\n        });\n    },\n    doComentFun(){// 处理评论逻辑\n        let that = this;\n        if(!that.talking) return;\n        // api/review/add?pid=10&content=喜欢666\n        let tmepTalk = that.talking;// 评论的内容\n        let pId=that.bean.id;// 评论的内容\n        let url = that.commentUrl + \"?pid=\" + pId+ \"&content=\" +tmepTalk;\n        \n        that.axios.post(url)\n            .then(response =>{\n                if(response.data.code === 200){\n                    that.talking=\"\";// 置空评论\n                    that.getData();\n                    that.$alert('评论成功','success',{\n                        confirmButtonText:'确定'\n                    })\n                }else{\n                    that.$alert('评论失败','error',{\n                        confirmButtonText:'确定'\n                    })\n                }\n            })\n            .catch((err)=>{\n                that.$alert('评论失败','error',{\n                        confirmButtonText:'确定'\n                })\n            })\n   \n   \n        },\n    handleBuy() {\n      if (!sessionStorage.getItem(\"user\")) {\n        this.$router.push(\"/login\");\n      } else {\n        let pid = this.bean.id;\n        let url = \"buy?pid=\" + pid + \"&num=\" + this.num;\n        this.axios.get(url).then((response) => {\n          let oiid = response.data;\n          this.$router.push({\n            path: \"/confirm\",\n            query: {\n              oiid: oiid,\n            },\n          });\n        });\n      }\n    },\n    handleAdd() {\n      if (!sessionStorage.getItem(\"user\")) {\n        this.$router.push(\"/login\");\n      }\n      let pid = this.bean.id;\n      let url = \"addCart?pid=\" + pid + \"&num=\" + this.num;\n      this.axios.get(url).then((response) => {\n        let result = response.data;\n        if (200 == result.code) {\n          this.$message(\"已加入购物车\");\n        }\n      });\n    },\n  },\n};\n</script>\n\n<style scoped>\n    .commentCss{\n        text-align: right;\n    }\n\n    .commentCss .el-button--primary{\n        margin-top: 10px;\n        margin-bottom: 20px;\n    }\n</style>"],"sourceRoot":"src/fore"}]}