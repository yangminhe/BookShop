{"remainingRequest":"/Volumes/Application/bookshop11/bookshop-vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/Application/bookshop11/bookshop-vue/src/fore/ProductPage.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Volumes/Application/bookshop11/bookshop-vue/src/fore/ProductPage.vue","mtime":1665085420000},{"path":"/Volumes/Application/bookshop11/bookshop-vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/Application/bookshop11/bookshop-vue/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Volumes/Application/bookshop11/bookshop-vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/Application/bookshop11/bookshop-vue/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGZvcm1hdERhdGUgfSBmcm9tICIuLi9zdG9yZS9mb3JtYXREYXRlIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJQcm9kdWN0UGFnZSIsCiAgZmlsdGVyczogewogICAgZm9ybWF0RGF0ZSh0aW1lKSB7CiAgICAgIGxldCBkYXRlID0gbmV3IERhdGUodGltZSk7CiAgICAgIHJldHVybiBmb3JtYXREYXRlKGRhdGUsICJ5eXl5LU1NLWRkIGhoOm1tIik7CiAgICB9LAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHRhbGtpbmc6ICIiLCAvLyDor4TorrrlhoXlrrkKCiAgICAgIHVyaTogInByb2R1Y3QiLAogICAgICBjb21tZW50VXJsOiAicmV2aWV3L2FkZCIsCgogICAgICBiZWFuOiBbXSwKICAgICAgcmV2aWV3OiBbXSwKICAgICAgbnVtOiAxLAogICAgICBhY3RpdmVOYW1lczogWyIxIl0sCiAgICB9OwogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuZ2V0RGF0YSgpOwogIH0sCiAKICBtZXRob2RzOiB7CiAgICBnZXREYXRhKCl7CiAgICAgICAgbGV0IHRoYXQgPSB0aGlzOwogICAgICAgIGxldCBpZCA9IHRoYXQuJHJvdXRlLnF1ZXJ5LmlkOwogICAgICAgIGxldCB1cmwgPSB0aGF0LnVyaSArICIvIiArIGlkOwogICAgICAgIHRoYXQuYXhpb3MuZ2V0KHVybCkudGhlbigocmVzKSA9PiB7CiAgICAgICAgbGV0IHJlc3VsdCA9IHJlcy5kYXRhOwogICAgICAgIHRoYXQuJG5leHRUaWNrKCgpPT57CiAgICAgICAgICAgIHRoYXQuYmVhbiA9IHJlc3VsdC5kYXRhLnByb2R1Y3Q7Ly8g5Lmm5pys55qE5a+56LGhCiAgICAgICAgICAgIHRoYXQucmV2aWV3ID0gcmVzdWx0LmRhdGEucmV2aWV3czsvLyDor4TorrrnmoTmlbDnu4QKICAgICAgICB9KTsKICAgICAgICB0aGF0LiRmb3JjZVVwZGF0ZSgpOwogICAgICAgIH0pOwogICAgfSwKICAgIGRvQ29tZW50RnVuKCl7Ly8g5aSE55CG6K+E6K666YC76L6RCiAgICAgICAgbGV0IHRoYXQgPSB0aGlzOwogICAgICAgIGlmKCF0aGF0LnRhbGtpbmcpIHJldHVybjsKICAgICAgICAvLyBhcGkvcmV2aWV3L2FkZD9waWQ9MTAmY29udGVudD3llpzmrKI2NjYKICAgICAgICBsZXQgdG1lcFRhbGsgPSB0aGF0LnRhbGtpbmc7Ly8g6K+E6K6655qE5YaF5a65CiAgICAgICAgbGV0IHBJZD10aGF0LmJlYW4uaWQ7Ly8g6K+E6K6655qE5YaF5a65CiAgICAgICAgbGV0IHVybCA9IHRoYXQuY29tbWVudFVybCArICI/cGlkPSIgKyBwSWQrICImY29udGVudD0iICt0bWVwVGFsazsKICAgICAgICAKICAgICAgICB0aGF0LmF4aW9zLnBvc3QodXJsKQogICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PnsKICAgICAgICAgICAgICAgIGlmKHJlc3BvbnNlLmRhdGEuY29kZSA9PT0gMjAwKXsKICAgICAgICAgICAgICAgICAgICB0aGF0LnRhbGtpbmc9IiI7Ly8g572u56m66K+E6K66CiAgICAgICAgICAgICAgICAgICAgdGhhdC5nZXREYXRhKCk7CiAgICAgICAgICAgICAgICAgICAgdGhhdC4kYWxlcnQoJ+ivhOiuuuaIkOWKnycsJ3N1Y2Nlc3MnLHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6J+ehruWumicKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgdGhhdC4kYWxlcnQoJ+ivhOiuuuWksei0pScsJ2Vycm9yJyx7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0Oifnoa7lrponCiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkKICAgICAgICAgICAgLmNhdGNoKChlcnIpPT57CiAgICAgICAgICAgICAgICB0aGF0LiRhbGVydCgn6K+E6K665aSx6LSlJywnZXJyb3InLHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6J+ehruWumicKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0pCiAgIAogICAKICAgICAgICB9LAogICAgaGFuZGxlQnV5KCkgewogICAgICBpZiAoIXNlc3Npb25TdG9yYWdlLmdldEl0ZW0oInVzZXIiKSkgewogICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCIvbG9naW4iKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBsZXQgcGlkID0gdGhpcy5iZWFuLmlkOwogICAgICAgIGxldCB1cmwgPSAiYnV5P3BpZD0iICsgcGlkICsgIiZudW09IiArIHRoaXMubnVtOwogICAgICAgIHRoaXMuYXhpb3MuZ2V0KHVybCkudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgIGxldCBvaWlkID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgcGF0aDogIi9jb25maXJtIiwKICAgICAgICAgICAgcXVlcnk6IHsKICAgICAgICAgICAgICBvaWlkOiBvaWlkLAogICAgICAgICAgICB9LAogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBoYW5kbGVBZGQoKSB7CiAgICAgIGlmICghc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgidXNlciIpKSB7CiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goIi9sb2dpbiIpOwogICAgICB9CiAgICAgIGxldCBwaWQgPSB0aGlzLmJlYW4uaWQ7CiAgICAgIGxldCB1cmwgPSAiYWRkQ2FydD9waWQ9IiArIHBpZCArICImbnVtPSIgKyB0aGlzLm51bTsKICAgICAgdGhpcy5heGlvcy5nZXQodXJsKS50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgIGxldCByZXN1bHQgPSByZXNwb25zZS5kYXRhOwogICAgICAgIGlmICgyMDAgPT0gcmVzdWx0LmNvZGUpIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoIuW3suWKoOWFpei0reeJqei9piIpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["ProductPage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ProductPage.vue","sourceRoot":"src/fore","sourcesContent":["<template>\n  <div>\n    <el-row :gutter=\"40\" style=\"text-align: center\">\n      <el-col :span=\"6\" :offset=\"6\">\n        <el-image\n          :src=\"bean.image\"\n          :lazy=\"true\"\n          fit=\"fill\"\n          style=\"height: 368px; width: 260px\"\n        />\n      </el-col>\n      <el-col :span=\"6\">\n        <h3>{{ bean.name }}</h3>\n        <p style=\"color: #9d9d9d\">{{ bean.author }}</p>\n        <h2 style=\"color: #fb4e44\">￥{{ bean.price }}</h2>\n        <el-tag type=\"success\">{{ bean.discount }}折</el-tag>\n        <p>{{ bean.publisher }}</p>\n        <el-input-number v-model=\"num\" :min=\"1\" :max=\"10\" />\n        <p>库存：{{ bean.stock }}件</p>\n        <el-button type=\"warning\" plain @click=\"handleAdd\"\n          >加入购物车</el-button\n        >\n        <el-button type=\"danger\" @click=\"handleBuy\">立即购买</el-button>\n      </el-col>\n    </el-row>\n    <el-row style=\"text-align: center; margin-top: 50px\">\n      <el-col :span=\"12\" :offset=\"6\">\n        <el-collapse>\n          <el-collapse-item title=\"评论\" style=\"text-align: left\">\n            <template slot=\"title\">\n              <i class=\"el-icon-copy-document\" />{{\n                bean.reviewCount\n              }}条书友评论999\n            </template>\n\n            <div class=\"commentCss\">\n              <el-input\n                type=\"textarea\"\n                :rows=\"2\"\n                placeholder=\"请输入评论内容\"\n                v-model=\"talking\">\n                </el-input>\n              <el-button type=\"primary\" @click.stop=\"doComentFun\">发布</el-button>\n            </div>\n\n            <!-- 评论卡片start -->\n            <el-card v-for=\"item in review\" :key=\"item.key\">\n              <el-tag v-if=\"item.user\">{{ item.user.name }}</el-tag>\n\n              <p>{{ item.content }}</p>\n\n              <el-tag type=\"info\" style=\"text-align: right\">{{\n                item.createTime | formatDate\n              }}</el-tag>\n            </el-card>\n            <!-- 评论卡片end -->\n          </el-collapse-item>\n        </el-collapse>\n      </el-col>\n    </el-row>\n  </div>\n</template>\n\n<script>\nimport { formatDate } from \"../store/formatDate\";\nexport default {\n  name: \"ProductPage\",\n  filters: {\n    formatDate(time) {\n      let date = new Date(time);\n      return formatDate(date, \"yyyy-MM-dd hh:mm\");\n    },\n  },\n  data() {\n    return {\n      talking: \"\", // 评论内容\n\n      uri: \"product\",\n      commentUrl: \"review/add\",\n\n      bean: [],\n      review: [],\n      num: 1,\n      activeNames: [\"1\"],\n    };\n  },\n  mounted() {\n    this.getData();\n  },\n \n  methods: {\n    getData(){\n        let that = this;\n        let id = that.$route.query.id;\n        let url = that.uri + \"/\" + id;\n        that.axios.get(url).then((res) => {\n        let result = res.data;\n        that.$nextTick(()=>{\n            that.bean = result.data.product;// 书本的对象\n            that.review = result.data.reviews;// 评论的数组\n        });\n        that.$forceUpdate();\n        });\n    },\n    doComentFun(){// 处理评论逻辑\n        let that = this;\n        if(!that.talking) return;\n        // api/review/add?pid=10&content=喜欢666\n        let tmepTalk = that.talking;// 评论的内容\n        let pId=that.bean.id;// 评论的内容\n        let url = that.commentUrl + \"?pid=\" + pId+ \"&content=\" +tmepTalk;\n        \n        that.axios.post(url)\n            .then(response =>{\n                if(response.data.code === 200){\n                    that.talking=\"\";// 置空评论\n                    that.getData();\n                    that.$alert('评论成功','success',{\n                        confirmButtonText:'确定'\n                    })\n                }else{\n                    that.$alert('评论失败','error',{\n                        confirmButtonText:'确定'\n                    })\n                }\n            })\n            .catch((err)=>{\n                that.$alert('评论失败','error',{\n                        confirmButtonText:'确定'\n                })\n            })\n   \n   \n        },\n    handleBuy() {\n      if (!sessionStorage.getItem(\"user\")) {\n        this.$router.push(\"/login\");\n      } else {\n        let pid = this.bean.id;\n        let url = \"buy?pid=\" + pid + \"&num=\" + this.num;\n        this.axios.get(url).then((response) => {\n          let oiid = response.data;\n          this.$router.push({\n            path: \"/confirm\",\n            query: {\n              oiid: oiid,\n            },\n          });\n        });\n      }\n    },\n    handleAdd() {\n      if (!sessionStorage.getItem(\"user\")) {\n        this.$router.push(\"/login\");\n      }\n      let pid = this.bean.id;\n      let url = \"addCart?pid=\" + pid + \"&num=\" + this.num;\n      this.axios.get(url).then((response) => {\n        let result = response.data;\n        if (200 == result.code) {\n          this.$message(\"已加入购物车\");\n        }\n      });\n    },\n  },\n};\n</script>\n\n<style scoped>\n    .commentCss{\n        text-align: right;\n    }\n\n    .commentCss .el-button--primary{\n        margin-top: 10px;\n        margin-bottom: 20px;\n    }\n</style>"]}]}