{"remainingRequest":"/Volumes/Application/bookshop11/bookshop-vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/Application/bookshop11/bookshop-vue/src/admin/Product.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Volumes/Application/bookshop11/bookshop-vue/src/admin/Product.vue","mtime":1664395824000},{"path":"/Volumes/Application/bookshop11/bookshop-vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/Application/bookshop11/bookshop-vue/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Volumes/Application/bookshop11/bookshop-vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/Application/bookshop11/bookshop-vue/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICAgIG5hbWU6ICJQcm9kdWN0IiwKCiAgICBkYXRhKCl7CiAgICAgICAgcmV0dXJuewogICAgICAgICAgICB1cmk6J3Byb2R1Y3RzJywKICAgICAgICAgICAgdG90YWw6MCwKICAgICAgICAgICAgcGFnZU51bToxLAogICAgICAgICAgICBiZWFuOltdLAogICAgICAgICAgICBvcHRpb25zOltdLAogICAgICAgICAgICB2YWx1ZTonJywKICAgICAgICAgICAgZGlhbG9nRm9ybVZpc2libGU6ZmFsc2UsCiAgICAgICAgICAgIGZvcm06ewogICAgICAgICAgICAgICAgaWQ6JycsCiAgICAgICAgICAgICAgICBuYW1lOicnLAogICAgICAgICAgICAgICAgcHJpY2U6JycsCiAgICAgICAgICAgICAgICBhdXRob3I6JycsCiAgICAgICAgICAgICAgICBwdWJsaXNoZXI6JycsCiAgICAgICAgICAgICAgICBkaXNjb3VudDonJywKICAgICAgICAgICAgICAgIHN0b2NrOicnLAogICAgICAgICAgICAgICAgY2lkOicnLAogICAgICAgICAgICB9LAogICAgICAgICAgICBmaWxlTGlzdDpbXQogICAgICAgIH0KICAgIH0sCgogICAgbW91bnRlZCgpIHsKICAgICAgICB0aGlzLmxpc3QoMSk7CiAgICAgICAgdGhpcy5heGlvcy5nZXQoJ2NhdGVnb3J5JykKICAgICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICB9KQogICAgfSwKCiAgICBtZXRob2RzOiB7CiAgICAgICAgbGlzdChwYWdlTnVtKSB7CiAgICAgICAgICAgIGxldCB1cmwgPSB0aGlzLnVyaSArICI/cGFnZU51bT0iICsgcGFnZU51bTsKICAgICAgICAgICAgdGhpcy5heGlvcy5nZXQodXJsKQogICAgICAgICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgICAgICAgICAgIHRoaXMuYmVhbiA9IHJlc3BvbnNlLmRhdGEuY29udGVudDsKICAgICAgICAgICAgICAgICAgICB0aGlzLnRvdGFsID0gcmVzcG9uc2UuZGF0YS50b3RhbEVsZW1lbnRzOwogICAgICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIGhhbmRsZUN1cnJlbnRDaGFuZ2UodmFsKSB7CiAgICAgICAgICAgIHRoaXMucGFnZU51bSA9IHZhbDsKICAgICAgICAgICAgdGhpcy5saXN0KHZhbCk7CiAgICAgICAgfSwKICAgICAgICBoYW5kbGVTZWxlY3QoaWQpewogICAgICAgICAgICBsZXQgdXJsID0gImNhdGVnb3JpZXMvIiArIGlkICsgIi9wcm9kdWN0cyIgKyAiP3BhZ2VOdW09IiArIHRoaXMucGFnZU51bTsKICAgICAgICAgICAgdGhpcy5heGlvcy5nZXQodXJsKQogICAgICAgICAgICAgICAgLnRoZW4oCiAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UgPT4gewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJlYW4gPSByZXNwb25zZS5kYXRhLmNvbnRlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudG90YWwgPSByZXNwb25zZS5kYXRhLnRvdGFsRWxlbWVudHM7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKQogICAgICAgIH0sCiAgICAgICAgaGFuZGxlQmFjaygpewogICAgICAgICAgdGhpcy5saXN0KDEpOwogICAgICAgIH0sCiAgICAgICAgaGFuZGxlT3BlbigpewogICAgICAgICAgICB0aGlzLmZvcm0uaWQgPSAnJzsKICAgICAgICAgICAgdGhpcy5mb3JtLm5hbWUgPSAnJzsKICAgICAgICAgICAgdGhpcy5mb3JtLnByaWNlID0gJyc7CiAgICAgICAgICAgIHRoaXMuZm9ybS5hdXRob3IgPSAnJzsKICAgICAgICAgICAgdGhpcy5mb3JtLnB1Ymxpc2hlciA9ICcnOwogICAgICAgICAgICB0aGlzLmZvcm0uZGlzY291bnQgPSAnJzsKICAgICAgICAgICAgdGhpcy5mb3JtLnN0b2NrID0gJyc7CiAgICAgICAgICAgIHRoaXMuZm9ybS5jaWQgPSAnJzsKICAgICAgICAgICAgdGhpcy5maWxlTGlzdCA9IFtdOwogICAgICAgICAgICB0aGlzLmRpYWxvZ0Zvcm1WaXNpYmxlID0gdHJ1ZTsKICAgICAgICB9LAogICAgICAgIGhhbmRsZUVkaXQoJGluZGV4LHJvdyl7CiAgICAgICAgICAgIHRoaXMuZm9ybSA9IHJvdzsKICAgICAgICAgICAgdGhpcy5maWxlTGlzdCA9IFtdOwogICAgICAgICAgICB0aGlzLmRpYWxvZ0Zvcm1WaXNpYmxlID0gdHJ1ZTsKICAgICAgICB9LAogICAgICAgIGhhbmRsZUZpbGUocmVzcG9uc2UpIHsKICAgICAgICAgICAgdGhpcy5maWxlTGlzdC5wdXNoKHJlc3BvbnNlLmZpbGUpCiAgICAgICAgfSwKICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnMKICAgICAgICBoYW5kbGVFeGNlZWQoZmlsZXMpIHsKICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKGDmnIDlpJrkuIrkvKAgJHtmaWxlcy5sZW5ndGh9IOS4quaWh+S7tmApCiAgICAgICAgfSwKICAgICAgICBoYW5kbGVDYW5jZWwoKXsKICAgICAgICAgICAgdGhpcy5kaWFsb2dGb3JtVmlzaWJsZSA9IGZhbHNlOwogICAgICAgICAgICB0aGlzLiRyZWZbJ2Zvcm0nXS5yZXNldEZpZWxkcygpOwogICAgICAgICAgICB0aGlzLmxpc3QoMSk7CiAgICAgICAgfSwKICAgICAgICBoYW5kbGVBZGQoKXsKICAgICAgICAgICAgbGV0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7CiAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnbmFtZScsIHRoaXMuZm9ybS5uYW1lKTsKICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdwcmljZScsIHRoaXMuZm9ybS5wcmljZSk7CiAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnYXV0aG9yJywgdGhpcy5mb3JtLmF1dGhvcik7CiAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgncHVibGlzaGVyJywgdGhpcy5mb3JtLnB1Ymxpc2hlcik7CiAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnZGlzY291bnQnLCB0aGlzLmZvcm0uZGlzY291bnQpOwogICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ3N0b2NrJywgdGhpcy5mb3JtLnN0b2NrKTsKICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdjaWQnLHRoaXMuZm9ybS5jaWQpOwogICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ2ZpbGUnLCB0aGlzLmZpbGVMaXN0WzBdKTsKICAgICAgICAgICAgaWYodGhpcy5mb3JtLmlkID09PSAnJyl7CiAgICAgICAgICAgICAgICB0aGlzLmF4aW9zLnBvc3QodGhpcy51cmksIGZvcm1EYXRhKQogICAgICAgICAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoMCAhPSByZXNwb25zZS5kYXRhLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaWFsb2dGb3JtVmlzaWJsZSA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVDdXJyZW50Q2hhbmdlKDEpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICBsZXQgdXJsPSB0aGlzLnVyaSArICIvIiArIHRoaXMuZm9ybS5pZDsKICAgICAgICAgICAgICAgIHRoaXMuYXhpb3MucHV0KHVybCwgZm9ybURhdGEpCiAgICAgICAgICAgICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBpZigwICE9IHJlc3BvbnNlLmRhdGEubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpYWxvZ0Zvcm1WaXNpYmxlID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUN1cnJlbnRDaGFuZ2UoMSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBoYW5kbGVEZWxldGUoJGluZGV4LHJvdyl7CiAgICAgICAgICAgIGxldCB1cmwgPSB0aGlzLnVyaSArICIvIiArIHJvdy5pZDsKICAgICAgICAgICAgdGhpcy5heGlvcy5kZWxldGUodXJsKQogICAgICAgICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgICAgICAgICAgIGlmKCAwID09PSByZXNwb25zZS5kYXRhLmxlbmd0aCApIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5iZWFuLnNwbGljZSgkaW5kZXgsIDEpOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUN1cnJlbnRDaGFuZ2UoMSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgfQp9Cg=="},{"version":3,"sources":["Product.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8IA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Product.vue","sourceRoot":"src/admin","sourcesContent":["<template>\n    <div>\n        <div>\n            <el-dialog title=\"编辑商品\"\n                       :visible.sync=\"dialogFormVisible\"\n                       center\n                       width=\"20%\" >\n                <el-form ref=\"form\"\n                        :model=\"form\"\n                        size=\"mini\">\n                    <el-form-item>\n                        <el-tag v-model=\"form.id\"\n                                v-show=\"false\"/>\n                    </el-form-item>\n                    <el-form-item label=\"商品图片\">\n                        <el-upload\n                                action=\"\"\n                                auto-upload=\"false\"\n                                :http-request=\"handleFile\"\n                                :multiple=\"false\"\n                                :limit=\"1\"\n                                :on-exceed=\"handleExceed\"\n                                :file-list=\"fileList\">\n                            <el-button size=\"small\" type=\"primary\">点击上传</el-button>\n                            <div slot=\"tip\" class=\"el-upload__tip\">只能上传jpg/png文件，且不超过500kb</div>\n                        </el-upload>\n                    </el-form-item>\n                    <el-form-item label=\"商品名称\">\n                        <el-input v-model=\"form.name\"/>\n                    </el-form-item>\n                    <el-form-item label=\"作者\">\n                        <el-input v-model=\"form.author\"/>\n                    </el-form-item>\n                    <el-form-item label=\"价格\">\n                        <el-input v-model=\"form.price\"/>\n                    </el-form-item>\n                    <el-form-item label=\"折扣\">\n                        <el-input v-model=\"form.discount\"/>\n                    </el-form-item>\n                    <el-form-item label=\"出版社\">\n                        <el-input v-model=\"form.publisher\"/>\n                    </el-form-item>\n                    <el-form-item label=\"库存\">\n                        <el-input v-model=\"form.stock\"/>\n                    </el-form-item>\n                    <el-form-item label=\"分类ID\">\n                        <el-input v-model=\"form.cid\"/>\n                    </el-form-item>\n                </el-form>\n                <div slot=\"footer\" class=\"dialog-footer\">\n                    <el-button type=\"primary\" @click=\"handleAdd\">确 定</el-button>\n                    <el-button @click=\"handleCancel\">取 消</el-button>\n                </div>\n            </el-dialog>\n            <el-select v-model=\"value\"\n                       filterable\n                       @change=\"handleSelect\"\n                       clearable\n                       @clear=\"handleBack\"\n                       placeholder=\"选择分类\"\n                       style=\"margin-bottom: 30px\">\n                <el-option\n                        v-for=\"item in options\"\n                        :key=\"item.id\"\n                        :label=\"item.name\"\n                        :value=\"item.id\">\n                </el-option>\n            </el-select>\n            <el-button\n                    type=\"primary\"\n                    icon=\"el-icon-circle-plus-outline\"\n                    @click=\"handleOpen\">添加商品\n            </el-button>\n        </div>\n        <div>\n            <el-table :data=\"bean\">\n                <el-table-column\n                        prop=\"id\"\n                        label=\"商品ID\"\n                        />\n                <el-table-column\n                        prop=\"name\"\n                        label=\"商品名称\"\n                        />\n                <el-table-column\n                        prop=\"image\"\n                        label=\"分类图片\"\n                        >\n                    <template slot-scope=\"scope\">\n                        <el-image\n                                style=\"width: 100px; height: 100px\"\n                                :src=\"scope.row.image\"\n                                fit=\"fill\"/>\n                    </template>\n                </el-table-column>\n                <el-table-column\n                    prop=\"author\"\n                    label=\"作者\"/>\n                <el-table-column\n                        prop=\"price\"\n                        label=\"价格\"/>\n                <el-table-column\n                        prop=\"discount\"\n                        label=\"折扣信息\"/>\n                <el-table-column\n                    prop=\"publisher\"\n                    label=\"出版社\"/>\n                <el-table-column\n                    prop=\"stock\"\n                    label=\"库存\"/>\n                <el-table-column\n                        label=\"操作\">\n                    <template slot-scope=\"scope\">\n                        <el-button\n                                type=\"primary\"\n                                icon=\"el-icon-edit\"\n                                @click=\"handleEdit(scope.$index,scope.row)\">\n                        </el-button>\n                        <el-button\n                                type=\"danger\"\n                                icon=\"el-icon-delete\"\n                                @click=\"handleDelete(scope.$index,scope.row)\">\n                        </el-button>\n                    </template>\n                </el-table-column>\n            </el-table>\n            <el-col :span=\"24\">\n                <el-pagination\n                        background\n                        layout=\"total,prev,pager,next\"\n                        :page-size=\"5\"\n                        :pager-count=\"5\"\n                        @current-change=\"handleCurrentChange\"\n                        :total=\"total\"\n                        :current-page=\"pageNum\"\n                />\n            </el-col>\n        </div>\n    </div>\n</template>\n\n<script>\n    export default {\n        name: \"Product\",\n\n        data(){\n            return{\n                uri:'products',\n                total:0,\n                pageNum:1,\n                bean:[],\n                options:[],\n                value:'',\n                dialogFormVisible:false,\n                form:{\n                    id:'',\n                    name:'',\n                    price:'',\n                    author:'',\n                    publisher:'',\n                    discount:'',\n                    stock:'',\n                    cid:'',\n                },\n                fileList:[]\n            }\n        },\n\n        mounted() {\n            this.list(1);\n            this.axios.get('category')\n                .then(response => {\n                    this.options = response.data;\n            })\n        },\n\n        methods: {\n            list(pageNum) {\n                let url = this.uri + \"?pageNum=\" + pageNum;\n                this.axios.get(url)\n                    .then(response => {\n                        this.bean = response.data.content;\n                        this.total = response.data.totalElements;\n                    })\n            },\n            handleCurrentChange(val) {\n                this.pageNum = val;\n                this.list(val);\n            },\n            handleSelect(id){\n                let url = \"categories/\" + id + \"/products\" + \"?pageNum=\" + this.pageNum;\n                this.axios.get(url)\n                    .then(\n                        response => {\n                            this.bean = response.data.content;\n                            this.total = response.data.totalElements;\n                        }\n                    )\n            },\n            handleBack(){\n              this.list(1);\n            },\n            handleOpen(){\n                this.form.id = '';\n                this.form.name = '';\n                this.form.price = '';\n                this.form.author = '';\n                this.form.publisher = '';\n                this.form.discount = '';\n                this.form.stock = '';\n                this.form.cid = '';\n                this.fileList = [];\n                this.dialogFormVisible = true;\n            },\n            handleEdit($index,row){\n                this.form = row;\n                this.fileList = [];\n                this.dialogFormVisible = true;\n            },\n            handleFile(response) {\n                this.fileList.push(response.file)\n            },\n            // eslint-disable-next-line no-unused-vars\n            handleExceed(files) {\n                this.$message.warning(`最多上传 ${files.length} 个文件`)\n            },\n            handleCancel(){\n                this.dialogFormVisible = false;\n                this.$ref['form'].resetFields();\n                this.list(1);\n            },\n            handleAdd(){\n                let formData = new FormData();\n                formData.append('name', this.form.name);\n                formData.append('price', this.form.price);\n                formData.append('author', this.form.author);\n                formData.append('publisher', this.form.publisher);\n                formData.append('discount', this.form.discount);\n                formData.append('stock', this.form.stock);\n                formData.append('cid',this.form.cid);\n                formData.append('file', this.fileList[0]);\n                if(this.form.id === ''){\n                    this.axios.post(this.uri, formData)\n                        .then(response => {\n                            if(0 != response.data.length) {\n                                this.dialogFormVisible = false;\n                                this.handleCurrentChange(1);\n                            }\n                        })\n                }else{\n                    let url= this.uri + \"/\" + this.form.id;\n                    this.axios.put(url, formData)\n                        .then(response => {\n                            if(0 != response.data.length) {\n                                this.dialogFormVisible = false;\n                                this.handleCurrentChange(1);\n                            }\n                        })\n                }\n            },\n            handleDelete($index,row){\n                let url = this.uri + \"/\" + row.id;\n                this.axios.delete(url)\n                    .then(response => {\n                        if( 0 === response.data.length ) {\n                            this.bean.splice($index, 1);\n                            this.handleCurrentChange(1);\n                        }\n                    });\n            }\n        }\n    }\n</script>\n\n<style scoped>\n\n</style>"]}]}