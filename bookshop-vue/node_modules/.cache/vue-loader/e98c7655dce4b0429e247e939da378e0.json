{"remainingRequest":"/Volumes/Application/bookshop/bookshop-vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/Application/bookshop/bookshop-vue/src/admin/Category.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Volumes/Application/bookshop/bookshop-vue/src/admin/Category.vue","mtime":1664395825109},{"path":"/Volumes/Application/bookshop/bookshop-vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/Application/bookshop/bookshop-vue/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Volumes/Application/bookshop/bookshop-vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/Application/bookshop/bookshop-vue/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICAgIG5hbWU6ICJDYXRlZ29yeSIsCiAgICBkYXRhKCl7CiAgICAgICAgcmV0dXJuewogICAgICAgICAgICB1cmk6J2NhdGVnb3JpZXMnLAogICAgICAgICAgICB0b3RhbDowLAogICAgICAgICAgICBwYWdlTnVtOjAsCiAgICAgICAgICAgIGNhdGVnb3J5OltdLAogICAgICAgICAgICBkaWFsb2dGb3JtVmlzaWJsZTpmYWxzZSwKICAgICAgICAgICAgZm9ybTp7CiAgICAgICAgICAgICAgICBpZDonJywKICAgICAgICAgICAgICAgIG5hbWU6JycKICAgICAgICAgICAgfSwKICAgICAgICAgICAgZmlsZUxpc3Q6W10KICAgICAgICB9CiAgICB9LAoKICAgIGNyZWF0ZWQoKSB7CiAgICAgICAgdGhpcy5saXN0KDEpOwogICAgfSwKCiAgICBtZXRob2RzOiB7CiAgICAgICAgbGlzdChwYWdlTnVtKSB7CiAgICAgICAgICAgIGxldCB1cmwgPSB0aGlzLnVyaSArICI/cGFnZU51bT0iICsgcGFnZU51bTsKICAgICAgICAgICAgdGhpcy5heGlvcy5nZXQodXJsKQogICAgICAgICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgICAgICAgdGhpcy5jYXRlZ29yeSA9IHJlc3BvbnNlLmRhdGEuY29udGVudDsKICAgICAgICAgICAgICAgIHRoaXMudG90YWwgPSByZXNwb25zZS5kYXRhLnRvdGFsRWxlbWVudHM7CiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICBoYW5kbGVDdXJyZW50Q2hhbmdlKHZhbCkgewogICAgICAgICAgICB0aGlzLnBhZ2VOdW0gPSB2YWw7CiAgICAgICAgICAgIHRoaXMubGlzdCh2YWwpOwogICAgICAgIH0sCiAgICAgICAgaGFuZGxlT3BlbigpewogICAgICAgICAgICB0aGlzLmZvcm0uaWQgPSAnJzsKICAgICAgICAgICAgdGhpcy5mb3JtLm5hbWUgPSAnJzsKICAgICAgICAgICAgdGhpcy5maWxlTGlzdCA9IFtdOwogICAgICAgICAgICB0aGlzLmRpYWxvZ0Zvcm1WaXNpYmxlID0gdHJ1ZTsKICAgICAgICB9LAogICAgICAgIGhhbmRsZUVkaXQoJGluZGV4LHJvdyl7CiAgICAgICAgICAgIHRoaXMuZm9ybSA9IHJvdzsKICAgICAgICAgICAgdGhpcy5maWxlTGlzdCA9IFtdOwogICAgICAgICAgICB0aGlzLmRpYWxvZ0Zvcm1WaXNpYmxlID0gdHJ1ZTsKICAgICAgICB9LAogICAgICAgIGhhbmRsZUZpbGUocmVzcG9uc2UpIHsKICAgICAgICAgICAgdGhpcy5maWxlTGlzdC5wdXNoKHJlc3BvbnNlLmZpbGUpCiAgICAgICAgfSwKICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnMKICAgICAgICBoYW5kbGVFeGNlZWQoZmlsZXMpIHsKICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKGDmnIDlpJrkuIrkvKAgJHtmaWxlcy5sZW5ndGh9IOS4quaWh+S7tmApCiAgICAgICAgfSwKICAgICAgICBoYW5kbGVDYW5jZWwoKXsKICAgICAgICAgICAgdGhpcy5kaWFsb2dGb3JtVmlzaWJsZSA9IGZhbHNlOwogICAgICAgICAgICB0aGlzLiRyZWZbJ2Zvcm0nXS5yZXNldEZpZWxkcygpOwogICAgICAgIH0sCiAgICAgICAgaGFuZGxlQWRkKCl7CiAgICAgICAgICAgIGxldCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpOwogICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ25hbWUnLCB0aGlzLmZvcm0ubmFtZSk7CiAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnZmlsZScsIHRoaXMuZmlsZUxpc3RbMF0pOwogICAgICAgICAgICBpZih0aGlzLmZvcm0uaWQgPT09ICcnKXsKICAgICAgICAgICAgICAgIHRoaXMuYXhpb3MucG9zdCh0aGlzLnVyaSwgZm9ybURhdGEpCiAgICAgICAgICAgICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBpZigwICE9IHJlc3BvbnNlLmRhdGEubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpYWxvZ0Zvcm1WaXNpYmxlID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUN1cnJlbnRDaGFuZ2UoMSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgIGxldCB1cmw9IHRoaXMudXJpICsgIi8iICsgdGhpcy5mb3JtLmlkOwogICAgICAgICAgICAgICAgdGhpcy5heGlvcy5wdXQodXJsLCBmb3JtRGF0YSkKICAgICAgICAgICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKDAgIT0gcmVzcG9uc2UuZGF0YS5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGUgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlQ3VycmVudENoYW5nZSgxKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGhhbmRsZURlbGV0ZSgkaW5kZXgscm93KXsKICAgICAgICAgICAgbGV0IHVybCA9IHRoaXMudXJpICsgIi8iICsgcm93LmlkOwogICAgICAgICAgICB0aGlzLmF4aW9zLmRlbGV0ZSh1cmwpCiAgICAgICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgICAgICBpZiggMCA9PT0gcmVzcG9uc2UuZGF0YS5sZW5ndGggKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5jYXRlZ29yeS5zcGxpY2UoJGluZGV4LCAxKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUN1cnJlbnRDaGFuZ2UoMSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH0KfQo="},{"version":3,"sources":["Category.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Category.vue","sourceRoot":"src/admin","sourcesContent":["<template>\n    <div>\n        <div>\n            <el-dialog title=\"分类编辑\"\n                       :visible.sync=\"dialogFormVisible\"\n                       center\n                       width=\"20%\" >\n                <el-form ref=\"form\"\n                        :model=\"form\">\n                    <el-form-item>\n                        <el-tag v-model=\"form.id\"\n                                v-show=\"false\"/>\n                    </el-form-item>\n                    <el-form-item label=\"分类图片\">\n                        <el-upload\n                                action=\"\"\n                                auto-upload=\"false\"\n                                :http-request=\"handleFile\"\n                                :multiple=\"false\"\n                                :limit=\"1\"\n                                :on-exceed=\"handleExceed\"\n                                :file-list=\"fileList\">\n                            <el-button size=\"small\" type=\"primary\">点击上传</el-button>\n                            <div slot=\"tip\" class=\"el-upload__tip\">只能上传jpg/png文件，且不超过500kb</div>\n                        </el-upload>\n                    </el-form-item>\n                    <el-form-item label=\"分类名称\">\n                        <el-input v-model=\"form.name\"></el-input>\n                    </el-form-item>\n                </el-form>\n                <div slot=\"footer\" class=\"dialog-footer\">\n                    <el-button type=\"primary\" @click=\"handleAdd\">确 定</el-button>\n                    <el-button @click=\"handleCancel\">取 消</el-button>\n                </div>\n            </el-dialog>\n            <el-button\n                    type=\"primary\"\n                    icon=\"el-icon-circle-plus-outline\"\n                    style=\"margin-bottom: 30px\"\n                    @click=\"handleOpen\">新增分类\n            </el-button>\n        </div>\n        <div>\n            <el-table :data=\"category\">\n                <el-table-column\n                        prop=\"id\"\n                        label=\"分类ID\"/>\n                <el-table-column\n                        prop=\"name\"\n                        label=\"分类名称\"/>\n                <el-table-column\n                    prop=\"image\"\n                    label=\"分类图片\">\n                    <template slot-scope=\"scope\">\n                    <el-image\n                            style=\"width: 100px; height: 100px\"\n                            :src=\"scope.row.image\"\n                            fit=\"fill\"/>\n                    </template>\n                </el-table-column>\n                <el-table-column\n                        label=\"操作\">\n                    <template slot-scope=\"scope\">\n                        <el-button\n                                type=\"primary\"\n                                icon=\"el-icon-edit\"\n                                @click=\"handleEdit(scope.$index,scope.row)\">编辑\n                        </el-button>\n                        <el-button\n                                type=\"danger\"\n                                icon=\"el-icon-delete\"\n                                @click=\"handleDelete(scope.$index,scope.row)\">删除\n                        </el-button>\n                    </template>\n                </el-table-column>\n            </el-table>\n        </div>\n        <div>\n            <el-col :span=\"24\">\n                <el-pagination\n                        background\n                        layout=\"total,prev,pager,next\"\n                        :page-size=\"5\"\n                        :pager-count=\"5\"\n                        @current-change=\"handleCurrentChange\"\n                        :total=\"total\"\n                        :current-page=\"pageNum\"\n                />\n            </el-col>\n        </div>\n    </div>\n</template>\n\n<script>\n    export default {\n        name: \"Category\",\n        data(){\n            return{\n                uri:'categories',\n                total:0,\n                pageNum:0,\n                category:[],\n                dialogFormVisible:false,\n                form:{\n                    id:'',\n                    name:''\n                },\n                fileList:[]\n            }\n        },\n\n        created() {\n            this.list(1);\n        },\n\n        methods: {\n            list(pageNum) {\n                let url = this.uri + \"?pageNum=\" + pageNum;\n                this.axios.get(url)\n                    .then(response => {\n                    this.category = response.data.content;\n                    this.total = response.data.totalElements;\n                })\n            },\n            handleCurrentChange(val) {\n                this.pageNum = val;\n                this.list(val);\n            },\n            handleOpen(){\n                this.form.id = '';\n                this.form.name = '';\n                this.fileList = [];\n                this.dialogFormVisible = true;\n            },\n            handleEdit($index,row){\n                this.form = row;\n                this.fileList = [];\n                this.dialogFormVisible = true;\n            },\n            handleFile(response) {\n                this.fileList.push(response.file)\n            },\n            // eslint-disable-next-line no-unused-vars\n            handleExceed(files) {\n                this.$message.warning(`最多上传 ${files.length} 个文件`)\n            },\n            handleCancel(){\n                this.dialogFormVisible = false;\n                this.$ref['form'].resetFields();\n            },\n            handleAdd(){\n                let formData = new FormData();\n                formData.append('name', this.form.name);\n                formData.append('file', this.fileList[0]);\n                if(this.form.id === ''){\n                    this.axios.post(this.uri, formData)\n                        .then(response => {\n                            if(0 != response.data.length) {\n                                this.dialogFormVisible = false;\n                                this.handleCurrentChange(1);\n                            }\n                        })\n                }else{\n                    let url= this.uri + \"/\" + this.form.id;\n                    this.axios.put(url, formData)\n                        .then(response => {\n                            if(0 != response.data.length) {\n                                this.dialogFormVisible = false;\n                                this.handleCurrentChange(1);\n                            }\n                        })\n                }\n            },\n            handleDelete($index,row){\n                let url = this.uri + \"/\" + row.id;\n                this.axios.delete(url)\n                    .then(response => {\n                    if( 0 === response.data.length ) {\n                        this.category.splice($index, 1);\n                        this.handleCurrentChange(1);\n                    }\n                });\n            }\n        }\n    }\n</script>\n\n<style scoped>\n</style>"]}]}